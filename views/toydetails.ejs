<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>toydetails</title>
    <!-- <link rel="stylesheet" href="Description.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="/css/navbar.css">
    <style>
        .main {
            margin: 0px;
            padding: 0px;
        }

        .upper {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            width: 1150px;
            margin: auto;
            gap: 2px;
        }

        .leftbar {
            padding: 50px;
            margin: 27px;
            box-shadow: rgba(212, 59, 59, 0.2) 0px 2px 8px 0px;
            border-radius: 15px;
            width: 450px;
            justify-content: space-between;
        }

        .upperimage {
            width: 335px;
            height: 335px;
            padding: 8px;
            margin: 2px;
            margin-top: 17px;
        }

        .lowerimage {
            padding: 0px;
            margin: auto;
            display: flex;
        }

        .lowerimages {
            width: 95px;
            height: 90px;
            padding: 8px;
            margin: 5px;
            box-shadow: rgba(212, 59, 59, 0.2) 0px 2px 8px 0px;
        }

        .rightbar {
            padding: 50px;
            margin: 27px;
            box-shadow: rgba(212, 59, 59, 0.2) 0px 2px 8px 0px;
            border-radius: 15px;
            width: 450px;
            justify-content: space-between;
        }

        .icon {
            display: flex;
            text-align: center;
            justify-content: left;
            align-items: center;
            gap: 40px;
        }

        .cart {
            display: flex;
            gap: 4px;
            justify-content: space-between;
            text-align: center;
            align-items: center;
        }

        .price {
            margin-top: 8px;
            display: flex;
            text-align: center;
            justify-content: space-between;
            gap: 12px;
        }

        .safe {
            padding: 2px;
            margin: 2px;
            border: 1px solid white;
            box-shadow: white 0px 2px 8px 0px;
        }

        .description {
            padding: 5px;
            margin: 2px;
            border: 1px solid whitesmoke;
            box-shadow: white 0px 3px 8px 0px;
        }

        .pg {
            padding: 3px;
            margin: 3px;
        }

        .bton {
            display: flex;
            /* justify-content: center;
       align-items: center; */
        }

        .img {
            padding: 1px;
            margin: 1px;
            display: flex;
            gap: 5px;
        }

        .review {
            color: #2D2D2D;
            width: 1150px;
            padding: 10px;
            margin: auto;
            box-shadow: rgba(212, 59, 59, 0.2) 0px 2px 8px 0px;
            border-radius: 15px;
            text-align: center;
            justify-content: center;
        }

        .rev {
            padding: 10px;
            margin: 24px;
            width: 180px;
            justify-content: left;
            display: flex;
            border: 1px solid white;
        }

        .des {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .input-box {
            width: 54px;
            padding: 8.5px;
            text-align: center;
            border: 2px solid black;
            color: blue;
            background-color: white;
            font-size: 14px;
        }

        .sec {
            background-color: white;
            color: blue;
            padding: 9px;
            width: 24px;
            border-right: none;
            border-top-left-radius: 20%;
            border-bottom-left-radius: 20%;
        }

        .sect {
            background-color: white;
            padding: 9px;
            color: blue;
            width: 24px;
            border-left: none;
            border-top-right-radius: 20%;
            border-bottom-right-radius: 20%;
        }

        .content {
            width: 300px;
            border: none 1px;
            padding: 15px;
            margin: 15px;
        }

        * {
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }

        .box {
            width: 300px;
            border: 1px solid whitesmoke;
            padding: 12px;
            margin: 12px;
            /* display: flex; */
            margin-left: -4px;
            border-radius: 18px;
            background: whitesmoke;
        }

        .button {
            justify-content: left;
            background: red;
            color: whitesmoke;
            border: none white;
            border-radius: 22px;
            padding: 4px;
            /* width: 70px; */
            font-weight: 600;
            height: 30px;
            width: 65px;
        }

        .icons {
            background: whiteS;
            border: white;
            border: brown;
        }

        .fa fa-shopping-cart {
            justify-content: end;
        }

        .custom-class {
            background: #ADD8E6;
            height: 100%;
            width: 100%;
        }

        .p {
            text-decoration: line-through;
        }

        .h {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .star {
            color: gold;
        }

        .img2 {
            width: 100%;
        }

        .product {
            /* width:1100px; */
            margin: auto;
            box-shadow: rgba(212, 59, 59, 0.2) 0px 2px 8px 0px;
            border-radius: 15px;
            display: flex;
            text-align: center;
            justify-content: center;
            align-items: center;
        }

        .footerimage {
            margin-top: 20px;
            gap: 30px;
            display: flex;
        }

        .space {
            color: #2D2D2D;
            margin-top: 12px;
            margin-bottom: 12px;
            display: flex;
        }

        .related {
            margin: 20px;
            text-align: start;
        }

        .container {
            border: 1px solid whitesmoke;
            position: relative;
            margin: auto;
            width: 230px;
            height: 240px;
        }

        .imageDiv {
            position: absolute;
            left: 3px;
            top: 4px;
            padding: 8px;
            border-radius: 9px;
            justify-content: left;
            background: red;
            color: whitesmoke;
            border: none;
            border-radius: 22px;
            padding: 4px;
            font-weight: 600;
            height: 30px;
            width: 65px;
        }

        .icons {
            top: 4px;
            left: 198px;
            position: absolute;
            background: white;
        }

        .item {
            display: flex;
        }

        .h3 {
            text-align: left;
        }

        .socialicon {
            margin: 6px;
        }

        .viewDetails {
            text-decoration: none;
            background-color: red;
            padding: 5px;
            border-radius: 7px
        }

        /* Media Query for Responsiveness */

        @media (max-width: 1208px) {
            .upper {
                width: 90%;
                flex-direction: column;
                padding: 0 10px;
            }

            .leftbar,
            .rightbar {
                width: 100%;
                margin: 10px auto;
                padding: 20px;
            }

            .upperimage {
                width: 100%;
                height: auto;
            }

            .review,
            .product {
                width: 100%;
                padding: 10px;
            }

            .footerimage {
                width: 100%;
                flex-direction: column;
                align-items: center;
            }

            .container {
                width: 200px;
                height: 200px;
            }
        }

        @media (max-width: 768px) {
            .upper {
                width: 90%;
                flex-direction: column;
                padding: 0 10px;
            }

            .leftbar,
            .rightbar {
                width: 100%;
                margin: 10px auto;
                padding: 20px;
            }

            .upperimage {
                width: 100%;
                height: auto;
            }

            .review,
            .product {
                width: 100%;
                padding: 10px;
            }

            .footerimage {
                width: 100%;
                flex-direction: column;
                align-items: center;
            }

            .container {
                width: 200px;
                height: 200px;
            }

            .qr-cd {
                height: 200px;
                width: 200px;
            }

            .qr-cd img {

                height: 100%;
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <%- include('common/navbar.ejs') %>
        <div class="main">
            <div class="upper">
                <div class="leftbar">
                    <div>
                        <div><img class="upperimage" src="<%= singleToy.ProductImageURL %>">
                        </div>
                    </div>
                </div>

                <div class="rightbar">
                    <div>
                        <h1>
                            <%= singleToy.ProductName %> <!-- Correct field name -->
                        </h1>
                        <p>Price: â‚¹<%= singleToy.Price %>
                        <p>Minimum-Order-Quantity: <%= singleToy.MinimumOrderQuantity %>

                        </p> <!-- Correct field name -->
                        <p>Description: <%= singleToy.ProductDescription %>
                        </p> <!-- Correct field name -->
                        <p>Category: <%= singleToy.Category %>
                        </p> <!-- Correct field name -->

                        <!-- Display QR Code -->
                        <h3>Scan QR Code for Product Details:</h3>
                        <!-- <img src="<%= singleToy.qrCodeUrl %>" alt="QR Code for <%= singleToy.ProductName %>"> -->
                        <div class="qr-cd">
                            <img width="100%"
                                src="<%= singleToy.qrCodeUrl ? singleToy.qrCodeUrl : 'data:image/png;base64,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' %>"
                                alt="QR Code for <%= singleToy.ProductName %>">
                        </div>
                    </div>

                    <div class="icon">
                        <div>
                            <div style="font-weight: bold;">
                                <p>Share this</p>
                            </div>
                        </div>
                        <div>
                            <p class="space">
                                <i class="fa fa-facebook-square socialicon"></i>
                                <i class="fa fa-instagram socialicon"></i>
                                <i class="fa fa-twitter socialicon"></i>
                            </p>
                        </div>
                    </div>

                    <div class="cart">
                        <div class="bton">
                            <!-- <div><button class="sec">&plus;</button></div> -->
                            <div><input type="number" class="input-box" value="1"></div>
                            <!-- <div><button class="sect">&minus;</button></div> -->
                        </div>
                        <div>
                            <button
                                style="border-radius: 7px; color:whitesmoke; background: #0F83B2; padding:9px; border:2px solid whitesmoke; cursor: pointer;"
                                class="btn addToCardBtn" type="button">
                                <i class="fa fa-shopping-cart"></i> Add to cart
                            </button>
                        </div>
                        <div>
                            <button
                                style="border-radius: 7px; color:whitesmoke; background: #0F83B2; padding:9px; border:2px solid whitesmoke; cursor: pointer;"
                                class="btn addToCardBtn" type="button">
                                <a href="/cart">Go To Cart</a>
                            </button>
                        </div>
                        <div class="img">
                            <div><i class="fa fa-heart-o"></i></div>
                            <div><i class="fa fa-refresh"></i></div>
                        </div>
                    </div>

                    <br>
                    <div class="description">
                        <div style="font-weight: bold;">Short Description</div>
                        <div class="price">
                            <div><span style="font-weight: bold">SKU</span> BG-1068</div>
                            <div><span style="font-weight: bold;">Category:</span> Educational Toy</div>
                        </div>
                        <div class="price">
                            <div><span style="font-weight: bold">TAG:</span> 2-5 years </div>
                            <div><span style="font-weight: bold;">EXP:</span> 06/08/2026</div>
                        </div>
                    </div>
                    <!-- <hr> -->
                    <!-- <div class="safe">
                        <div>Guaranteed Safe Checkout</div>
                        <div>
                            <img src="/images/Frame 147.png">
                        </div>
                    </div> -->
                </div>
            </div>
            <br>

            <div style="text-align: center;margin-bottom: 20px;">
                <h1>Related Products</h1>
            </div>
            <div class="product">
                <div class="footerimage">
                    <% relatedToys.forEach(toy=> { %>
                        <div class="related">
                            <div>
                                <div class="container">
                                    <img width="100%" height="100%" src="<%= toy.ProductImageURL %>"
                                        alt="<%= toy.ProductName %>">
                                    <button class="imageDiv">Sale</button>
                                </div>
                            </div>
                            <div>
                                <h3 class="h3">
                                    <%= toy.ProductName %>
                                </h3>
                                <div class="h">
                                    <h2 style="color:green">â‚¹<%= toy.Price %>
                                    </h2>
                                    <p class="p">
                                    <h3>â‚¹<%= toy.Price + 40 %>
                                    </h3>
                                    </p>
                                </div>
                                <a class="viewDetails" href="/toydetails/<%= toy._id %>">View Details</a>
                                <!-- Use _id instead of id -->
                            </div>
                        </div>
                        <% }); %>
                </div>
            </div>
        </div>

        <%- include('common/footer.ejs') %>
</body>

</html>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const addToCartBtn = document.querySelector(".addToCardBtn");
        const inputBox = document.querySelector(".input-box");

        addToCartBtn.addEventListener("click", async function () {
            const quantity = parseInt(inputBox.value) > 0 ? parseInt(inputBox.value) : 1;

            const product = {
                _id: "<%= singleToy._id %>",
                ProductName: "<%= singleToy.ProductName %>",
                Price: "<%= singleToy.Price %>",
                ProductImageURL: "<%= singleToy.ProductImageURL %>",
                qrCodeUrl: "<%= singleToy.qrCodeUrl %>",
                quantity: quantity
            };

            try {
                const response = await fetch('/add-to-cart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(product)
                });

                const data = await response.json();

                if (response.ok) {
                    alert(`${product.ProductName} added to cart successfully!`);
                } else {
                    alert(data.message || "Failed to add item to cart.");
                }
            } catch (error) {
                console.error("Error:", error);
                alert("Error adding to cart.");
            }
        });
    });
</script>

<!-- <script>
    document.addEventListener("DOMContentLoaded", function () {
        const addToCartBtn = document.querySelector(".addToCardBtn");
        const inputBox = document.querySelector(".input-box");

        addToCartBtn.addEventListener("click", function () {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];

            // Get product details
            const product = {
                id: "<%= singleToy._id %>",
                name: "<%= singleToy.name %>",
                price: "<%= singleToy.price %>",
                imageUrl: "/<%= singleToy.imageUrl %>",
                quantity: parseInt(inputBox.value) || 1,
                qrCodeUrl: "<%= singleToy.qrCodeUrl %>"
            };

            // Check if product already exists in the cart
            const existingProduct = cart.find(item => item.id === product.id);
            if (existingProduct) {
                existingProduct.quantity += product.quantity; // Increase quantity
            } else {
                cart.push(product); // Add new product
            }

            // Save updated cart to localStorage
            localStorage.setItem("cart", JSON.stringify(cart));

            alert("Product added to cart successfully!");
        });
    });

</script> -->
<!-- <script>
    document.addEventListener("DOMContentLoaded", function () {
        const addToCartBtn = document.querySelector(".addToCardBtn");
        const inputBox = document.querySelector(".input-box");

        addToCartBtn.addEventListener("click", function () {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];

            // Get product details with corrected property names
            const product = {
                id: "<%= singleToy._id %>",
                name: "<%= singleToy.ProductName %>",
                price: <%= singleToy.Price %>,  // Ensure this is a number
                imageUrl: "<%= singleToy.ProductImageURL %>",
                quantity: parseInt(inputBox.value) > 0 ? parseInt(inputBox.value) : 1,
                qrCodeUrl: "/<%= singleToy.qrCodeUrl %>"
                // qrCodeUrl: productBox.querySelector('.qrcode').src
            };

            // let product = {
            //     id: productBox.querySelector('a').getAttribute('href').split('/').pop(), // Extract ID from URL
            //     name: productBox.querySelector('h3').textContent.trim(),
            //     price: productBox.querySelector('.h h2').textContent.replace('â‚¹', '').trim(),
            //     imageUrl: productBox.querySelector('img').src,
            //     qrCodeUrl: productBox.querySelector('.qrcode').src
            // };

            // Check if product already exists in the cart
            const existingProduct = cart.find(item => item.id === product.id);
            if (existingProduct) {
                existingProduct.quantity += product.quantity; // Increase quantity
            } else {
                cart.push(product); // Add new product
            }

            // Save updated cart to localStorage
            localStorage.setItem("cart", JSON.stringify(cart));

            alert(`${product.name} added to cart successfully!`);
        });
    });
</script> -->
